#!/bin/bash

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(head -n1 "$COMMIT_MSG_FILE")

# Check length
if [ ${#COMMIT_MSG} -gt 60 ]; then
    echo "Error: Commit message first line is longer than 60 characters."
    exit 1
fi

# Check lowercase
if [[ "$COMMIT_MSG" =~ [A-Z] ]]; then
    echo "Error: Commit message first line contains uppercase letters."
    exit 1
fi

# Check starts with conventional commit type
if ! [[ "$COMMIT_MSG" =~ ^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert): ]]; then
    echo "Error: Commit message must start with a conventional commit type (feat:, fix:, docs:, style:, refactor:, test:, chore:, perf:, ci:, build:, revert:)."
    exit 1
fi

echo "Commit message is valid."
exit 0